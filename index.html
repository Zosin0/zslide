<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZSlide</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        #render {
            width: 100%;
            height: 100%;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    


</head>

<body>
    <div style="display: flex; width: 100vw; height: 100vh">
        <textarea id="md" style="flex: 1; resize: none; padding: 10px; box-sizing: border-box;"
            placeholder="Digite seu Markdown aqui..."></textarea>
        <div id="render" style="flex: 1; overflow-y: auto; padding: 10px; box-sizing: border-box;"></div>
    </div>

    <button id="exportPdf">Export as PDF</button>

    <script type="module">
        import { Marp } from 'https://esm.sh/@marp-team/marp-core?bundle'
        import browser from 'https://esm.sh/@marp-team/marp-core/browser'

        const marp = new Marp({ script: false, html: true, minifyCSS: true, html2canvas: { scale: 4, useCORS: true } })

        const md = document.getElementById('md')
        const render = document.getElementById('render')

        // Renderiza o Markdown em HTML conforme o usuário digita
        md.addEventListener('input', () => {
            const { html, css } = marp.render(md.value);
            render.innerHTML = `${html}<style>${css}</style>`;

            // Envia o conteúdo HTML para o servidor
            fetch('/save-content', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ html: render.innerHTML })
            }).then(response => response.text()).then(message => {
                console.log(message);
            }).catch(error => {
                console.error('Erro ao gerar PDF:', error);
            });
        });

        // Função para exportar como PDF usando html2pdf.js
        document.getElementById('exportPdf').addEventListener('click', () => {
            const contentToExport = render.cloneNode(true)

            // Captura o conteúdo renderizado e exporta como PDF
            html2pdf().from(contentToExport).save()
        })
    </script>
</body>

</html>
